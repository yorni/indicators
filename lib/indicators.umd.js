!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).indicators={})}(this,(function(t){"use strict";var e=function(){function t(t){this.length=t,this.pointer=0,this.filledCache=!1,this.buffer=new Array(t).fill(0)}return t.prototype.push=function(t){var e=this.buffer[this.pointer];return this.buffer[this.pointer]=t,this.pointer=(this.length+this.pointer+1)%this.length,e},t.prototype.pushback=function(t){this.pointer=(this.length+this.pointer-1)%this.length;var e=this.buffer[this.pointer];return this.buffer[this.pointer]=t,e},t.prototype.current=function(){return this.buffer[this.pointer]},t.prototype.toArray=function(){return this.buffer},t.prototype.filled=function(){return this.filledCache=this.filledCache||this.pointer===this.length-1,this.filledCache},t}(),i=function(){function t(t){this.period=t,this.sum=0,this.fill=0,this.circular=new e(t)}return t.prototype.nextValue=function(t){var e=this;if(this.sum+=t,this.sum-=this.circular.push(t),this.fill++,this.fill===this.period)return this.nextValue=function(t){return e.sum+=t,e.sum-=e.circular.push(t),e.sum/e.period},this.momentValue=function(t){var i=e.circular.current();return(e.sum-i+t)/e.period},this.sum/this.period},t.prototype.momentValue=function(t){},t}(),s=function(){function t(t){this.period=t,this.smooth=1/this.period,this.sma=new i(this.period)}return t.prototype.nextValue=function(t){return this.rma?(this.rma&&(this.rma=(t-this.rma)*this.smooth+this.rma),this.rma):this.rma=this.sma.nextValue(t)},t.prototype.momentValue=function(t){if(this.rma)return(t-this.rma)*this.smooth+this.rma},t}(),r=function(){function t(t){this.period=t,this.fill=0,this.smooth=2/(this.period+1),this.sma=new i(this.period)}return t.prototype.nextValue=function(t){var e=this;this.fill++;var i=this.sma.nextValue(t);return this.fill===this.period&&(this.ema=i,this.nextValue=function(t){return e.ema=(t-e.ema)*e.smooth+e.ema}),this.ema},t.prototype.momentValue=function(t){if(this.ema)return(t-this.ema)*this.smooth+this.ema},t}(),n=function(){function t(t,e,i,s){void 0===i&&(i=.85),void 0===s&&(s="RMA"),this.period=t,this.samples=e,this.redunant=i,this.type=s,this.upper=0,this.lower=0,this.lastUpperValue=0,this.lastLowerValue=0,this.sample1Up=this.createSample(),this.sample2Up=this.createSample(),this.sample3Up=this.createSample(),this.sample1Low=this.createSample(),this.sample2Low=this.createSample(),this.sample3Low=this.createSample()}return t.prototype.nextValue=function(t){return t>0?(this.upper=this.getUp(t),this.lastLowerValue*=this.redunant,this.lower=this.getDown(this.lastLowerValue),this.lastUpperValue=t):t<0&&(this.lower=this.getDown(t),this.lastUpperValue*=this.redunant,this.upper=this.getUp(this.lastUpperValue),this.lastLowerValue=t),{upper:this.upper,lower:this.lower}},t.prototype.getUp=function(t){var e=this.sample1Up.nextValue(t),i=null;return 1===this.samples?e:(e&&(i=this.sample2Up.nextValue(e)),2===this.samples?i:i?this.sample3Up.nextValue(i):null)},t.prototype.getDown=function(t){var e=this.sample1Low.nextValue(t),i=null;return 1===this.samples?e:(e&&(i=this.sample2Low.nextValue(e)),2===this.samples?i:i?this.sample3Low.nextValue(i):null)},t.prototype.createSample=function(){switch(this.type){case"EMA":return new r(this.period);case"RMA":return new s(this.period);case"SMA":return new i(this.period)}},t}(),o=function(){function t(t){this.period=t,this.SMAx=new i(this.period),this.SMAy=new i(this.period),this.pricesX=new e(this.period),this.pricesY=new e(this.period)}return t.prototype.nextValue=function(t,e){this.pricesX.push(t),this.pricesY.push(e),this.SMAxValue=this.SMAx.nextValue(t),this.SMAyValue=this.SMAy.nextValue(e);for(var i=0,s=0,r=0,n=0;n<this.period;n++){var o=this.pricesX[n],h=this.pricesY[n];i+=(o-this.SMAxValue)*(h-this.SMAyValue),s+=Math.pow(o-this.SMAxValue,2),r+=Math.pow(h-this.SMAyValue,2)}return i/Math.sqrt(s*r)},t}();var h=function(t,e){return(t-e)/e*100},a=function(t){for(var e=-1/0,i=0,s=t.length-1;s>=0;s--){var r=t[s];e<r&&(i=s,e=r)}return{max:e,idx:i}},u=function(t){for(var e=1/0,i=0,s=t.length-1;s>=0;s--){var r=t[s];e>r&&(i=s,e=r)}return{min:e,idx:i}},p=function(){function t(t){this.period=t,this.value=0,this.changes=new e(t)}return t.prototype.nextValue=function(t){if(this.prevPrice){var e=h(t,this.prevPrice);return this.calculate(e),this.prevPrice=t,this.value}this.prevPrice=t},t.prototype.calculate=function(t){return this.value+=t,this.value-=this.changes.push(t),this.value},t}(),l=function(){return(l=Object.assign||function(t){for(var e,i=arguments,s=1,r=arguments.length;s<r;s++)for(var n in e=i[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function c(t){return t.consolidate=0,t.power=0,t.streak=0,t.diff=0,t.startPrice=0,t.prevPeak=0,t}var f=function(){function t(){this.up={consolidate:0,power:0,streak:0,startPrice:0,diff:0,prevPeak:0},this.down={consolidate:0,power:0,streak:0,startPrice:0,diff:0,prevPeak:0}}return t.prototype.nextValue=function(t,e,i,s){if(t<e||this.up.streak&&this.up.prevPeak<s){this.up.startPrice||(this.up.startPrice=t),this.down.streak&&c(this.down);var r=e-t;this.up.streak++,this.up.prevPeak=s,this.up.diff>r?this.up.consolidate++:this.up.consolidate=0,this.up.diff=r,this.up.power=h(e,this.up.startPrice)}if(t>e||this.down.streak&&this.down.prevPeak>i){this.down.startPrice||(this.down.startPrice=t),this.up.streak&&c(this.up);r=t-e;this.down.streak++,this.down.prevPeak=i,this.down.diff>r?this.down.consolidate++:this.down.consolidate=0,this.down.diff=r,this.down.power=h(e,this.down.startPrice)}return t===e&&(this.up.streak++,this.down.streak++,this.up.diff=this.down.diff=0),this.up.streak>this.down.streak?l({},this.up):l({},this.down)},t}(),d=function(){function t(t,s){void 0===t&&(t=14),void 0===s&&(s=3),this.period=t,this.smaPeriod=s,this.higestH=null,this.lowestL=null,this.fill=0,this.sma=new i(this.smaPeriod),this.highs=new e(this.period),this.lows=new e(this.period)}return t.prototype.nextValue=function(t,e,i){var s=this;this.fill++;var r=this.fill===this.period;if(r||(this.highs.push(t),this.lows.push(e)),r&&!this.higestH&&!this.lowestL)return this.higestH=a(this.highs.toArray()).max,this.lowestL=u(this.lows.toArray()).min,this.nextValue=function(t,e,i){var r=s.highs.push(t),n=s.lows.push(e);s.higestH===r?s.higestH=a(s.highs.toArray()).max:s.higestH<t&&(s.higestH=t),s.lowestL===n?s.lowestL=u(s.lows.toArray()).min:s.lowestL>e&&(s.lowestL=e);var o=(i-s.lowestL)/(s.higestH-s.lowestL)*100;return{k:o,d:s.sma.nextValue(o)}},this.momentValue=function(t,e,i){var r=s.highs.push(t),n=s.lows.push(e),o=s.higestH,h=s.lowestL;o===r?o=a(s.highs.toArray()).max:o<t&&(o=t),h===n?h=u(s.lows.toArray()).min:h>e&&(h=e),s.highs.pushback(r),s.lows.pushback(n);var p=(i-h)/(o-h)*100;return{k:p,d:s.sma.momentValue(p)}},this.nextValue(t,e,i)},t.prototype.momentValue=function(t,e,i){},t}(),m=function(){function t(t){this.period=t,this.sum=0,this.avg=0,this.filled=!1,this.fill=0}return t.prototype.nextValue=function(t){var e=this;return this.filled&&this.avg?(this.nextValue=function(t){return e.avg=(e.avg*(e.period-1)+t)/e.period},this.nextValue(t)):(this.sum+=t,this.fill++,this.fill===this.period?(this.filled=!0,this.avg=this.sum/this.period,this.avg):void 0)},t.prototype.momentValue=function(t){if(this.filled)return(this.avg*(this.period-1)+t)/this.period},t}(),v=function(){function t(t){this.avgGain=new m(t),this.avgLoss=new m(t)}return t.prototype.nextValue=function(t){var e=t-this.prev;if(this.prev){var i=e>0?e:0,s=e<0?e:0,r=this.avgGain.nextValue(i),n=this.avgLoss.nextValue(s);return this.prev=t,{upAvg:r,downAvg:n}}this.prev=t},t.prototype.momentValue=function(t){var e=t-this.prev,i=e>0?e:0,s=e<0?e:0;return{upAvg:this.avgGain.momentValue(i),downAvg:this.avgLoss.momentValue(s)}},t}(),w=function(){function t(t){void 0===t&&(t=14),this.period=t,this.change=new v(this.period)}return t.prototype.nextValue=function(t){var e=this.change.nextValue(t)||{},i=e.downAvg,s=e.upAvg;if(void 0!==s&&void 0!==i)return 100-100/(1+s/-i)},t.prototype.momentValue=function(t){var e=this.change.momentValue(t)||{},i=e.downAvg,s=e.upAvg;if(void 0!==s&&void 0!==i)return 100-100/(1+s/-i)},t}(),V=function(){function t(t){this.period=t,this.values=new e(t)}return t.prototype.nextValue=function(t,e){this.values.push(t);var i=this.values.toArray().reduce((function(t,i){return t+Math.abs(e-i)}),0);return e&&i/this.period},t.prototype.momentValue=function(t,e){var i=this.values.push(t),s=this.values.toArray().reduce((function(t,i){return t+Math.abs(e-i)}),0);return this.values.pushback(i),e&&s/this.period},t}(),y=function(){function t(t){void 0===t&&(t=20),this.md=new V(t),this.sma=new i(t)}return t.prototype.nextValue=function(t,e,i){var s=(t+e+i)/3,r=this.sma.nextValue(s),n=this.md.nextValue(s,r);return n&&(s-r)/(.015*n)},t.prototype.momentValue=function(t,e,i){var s=(t+e+i)/3,r=this.sma.momentValue(s),n=this.md.momentValue(s,r);return n&&(s-r)/(.015*n)},t}(),g=function(){function t(t){void 0===t&&(t=14),this.avg=new i(t),this.prevClose=0}return t.prototype.nextValue=function(t,e,i){var s=this.getTrueRange(t,e);return this.prevClose=i,this.avg.nextValue(s)},t.prototype.momentValue=function(t,e){var i=this.getTrueRange(t,e);return this.avg.momentValue(i)},t.prototype.getTrueRange=function(t,e){return this.prevClose?Math.max(t-e,Math.abs(t-this.prevClose),Math.abs(e-this.prevClose)):t-e},t}(),x=function(){function t(t){void 0===t&&(t=5),this.values=new e(t)}return t.prototype.nextValue=function(t){var e=this.values.push(t);if(0!==e)return(t-e)/e},t.prototype.momentValue=function(t){var e=this.values.current();if(0!==e)return(t-e)/e},t}(),A=function(){function t(t){void 0===t&&(t=20),this.max=-1/0,this.min=1/0,this.highest=new e(t+1),this.lowest=new e(t+1)}return t.prototype.nextValue=function(t,e){this.max<t&&(this.max=t),this.min>e&&(this.min=e);var i=this.highest.push(t),s=this.lowest.push(e);return i===this.max&&t!==this.max&&(this.max=a(this.highest.toArray()).max),s===this.min&&e!==this.min&&(this.min=u(this.lowest.toArray()).min),{upper:this.max,middle:(this.max+this.min)/2,lower:this.min}},t.prototype.momentValue=function(t,e){var i=this.max,s=this.min;i<t&&(i=t),s>e&&(s=e);var r=this.highest.push(t),n=this.lowest.push(e);if(this.highest.filled())return r===i&&t!==i&&(i=a(this.highest.toArray()).max),n===s&&e!==s&&(s=u(this.lowest.toArray()).min),this.highest.pushback(r),this.lowest.pushback(n),{upper:this.max,middle:(t+e)/2,lower:this.min}},t}(),k=function(){function t(t){this.period=t,this.fill=0,this.values=new e(t)}return t.prototype.nextValue=function(t){var e=this;if(this.values.push(t),this.fill++,this.fill===this.period)return this.nextValue=function(t){var i=e.calc(t);return e.values.push(t),i},this.momentValue=this.calc,this.calc(t)},t.prototype.momentValue=function(t){},t.prototype.calc=function(t){var e=0;return this.values.toArray().forEach((function(i){i<=t&&e++})),e/this.period*100},t}(),M=function(){function t(t,e,i){void 0===t&&(t=3),void 0===e&&(e=2),void 0===i&&(i=100),this.period=t,this.rsi=new w(this.period),this.updownRsi=new w(e),this.roc=new x(1),this.percentRank=new k(i),this.updownPeriod=0,this.prevClose=0}return t.prototype.nextValue=function(t){var e=this.rsi.nextValue(t),i=this.percentRank.nextValue(this.roc.nextValue(t));if(this.updownPeriod=this.getUpdownPeriod(t),this.prevClose=t,this.updownValue=this.updownRsi.nextValue(this.updownPeriod),this.updownValue)return(e+this.updownValue+i)/3},t.prototype.momentValue=function(t){var e=this.rsi.momentValue(t),i=this.percentRank.momentValue(this.roc.momentValue(t)),s=this.getUpdownPeriod(t),r=this.updownRsi.momentValue(s);if(r)return(e+r+i)/3},t.prototype.getUpdownPeriod=function(t){var e=this.updownPeriod;return t>this.prevClose?(this.updownPeriod<0&&(e=0),e++):t<this.prevClose?(this.updownPeriod>0&&(e=0),e--):e=0,e},t}(),P=function(){function t(t){this.period=t,this.values=new e(t)}return t.prototype.nextValue=function(t,e){return this.values.push(t),Math.sqrt(this.values.toArray().reduce((function(t,i){return t+Math.pow(i-e,2)}),0)/this.period)},t.prototype.momentValue=function(t,e){var i=this.values.push(t),s=Math.sqrt(this.values.toArray().reduce((function(t,i){return t+Math.pow(i-e,2)}),0)/this.period);return this.values.pushback(i),s},t.prototype.calculate=function(t,e,i){},t}(),S=function(){function t(t,e){void 0===t&&(t=20),void 0===e&&(e=2),this.period=t,this.stdDev=e,this.fill=0,this.sma=new i(t),this.sd=new P(t)}return t.prototype.nextValue=function(t){var e=this,i=this.sma.nextValue(t),s=this.sd.nextValue(t,i);if(this.fill++,this.fill===this.period){var r=i-this.stdDev*s,n=i+this.stdDev*s;return this.nextValue=function(t){var i=e.sma.nextValue(t),s=e.sd.nextValue(t,i);return{lower:i-e.stdDev*s,middle:i,upper:i+e.stdDev*s}},{lower:r,middle:i,upper:n}}},t.prototype.momentValue=function(t){var e=this.sma.momentValue(t),i=this.sd.momentValue(t,e);return{lower:e-this.stdDev*i,middle:e,upper:e+this.stdDev*i}},t}(),b=function(){function t(t,e,i){void 0===t&&(t=12),void 0===e&&(e=26),void 0===i&&(i=9),this.periodEmaFast=t,this.periodEmaSlow=e,this.periodSignal=i,this.emaFastIndicator=new r(t),this.emaSlowIndicator=new r(e),this.emaSignalIndicator=new r(i)}return t.prototype.nextValue=function(t){var e=this.emaFastIndicator.nextValue(t),i=this.emaSlowIndicator.nextValue(t),s=e-i,r=s&&this.emaSignalIndicator.nextValue(s)||void 0,n=s-r||void 0;if(!isNaN(s))return{macd:s,emaFast:e,emaSlow:i,signal:r,histogram:n}},t.prototype.momentValue=function(t){var e=this.emaFastIndicator.momentValue(t),i=this.emaSlowIndicator.momentValue(t),s=e-i,r=s&&this.emaSignalIndicator.momentValue(s);return{macd:s,emaFast:e,emaSlow:i,signal:r,histogram:s-r}},t}(),L=function(){function t(){this.prevOpen=0,this.prevClose=0}return t.prototype.nextValue=function(t,e,i,s){var r=this.calculate(t,e,i,s);return this.prevClose=r.c,this.prevOpen=r.o,r},t.prototype.momentValue=function(t,e,i,s){return this.calculate(t,e,i,s)},t.prototype.calculate=function(t,e,i,s){return s=(t+e+i+s)/4,this.prevOpen&&(t=(this.prevOpen+this.prevClose)/2),{o:t,h:e=Math.max(e,t,s),l:i=Math.min(i,t,s),c:s}},t}(),C=function(){function t(t){switch(void 0===t&&(t="classic"),this.mode=t,this.mode){case"classic":this.calculator=this.classic;break;case"camarilla":this.calculator=this.camarilla;break;case"woodie":this.calculator=this.woodie;break;case"fibonacci":this.calculator=this.fibonacci}}return t.prototype.nextValue=function(t,e,i){return this.calculator(t,e,i)},t.prototype.classic=function(t,e,i){var s=(t+e+i)/3;return{r3:t+2*(s-e),r2:s+(t-e),r1:2*s-e,pp:s,s1:2*s-t,s2:s-(t-e),s3:e-2*(t-s)}},t.prototype.woodie=function(t,e,i){var s=(t+e+2*i)/4;return{r2:s+t-e,r1:2*s-e,pp:s,s1:2*s-t,s2:s-t+e}},t.prototype.camarilla=function(t,e,i){var s=t-e;return{r4:i+1.5*s,r3:i+1.25*s,r2:i+1.1666*s,r1:i+1.0833*s,pp:(t+e+i)/3,s1:i-1.0833*s,s2:i-1.1666*s,s3:i-1.25*s,s4:i-1.5*s}},t.prototype.fibonacci=function(t,e,i){var s=t-e,r=(t+e+i)/3;return{r3:r+s,r2:r+.618*s,r1:r+.382*s,pp:r,s1:r-.382*s,s2:r-.618*s,s3:r-s}},t}(),R=function(){function t(t){this.period=t,this.arr=[],this.filled=!1,this.devider=0,this.devider=function(t){for(var e=0,i=t.length;i>0;)e+=t[--i];return e}(Array.from(Array(this.period).keys()).map((function(t){return t+1})))}return t.prototype.nextValue=function(t){if(this.filled=this.filled||this.arr.length===this.period,this.arr.push(t),this.filled)return this.arr.shift(),this.arr.reduce((function(t,e,i){return t+e*(i+1)}),0)/this.devider},t.prototype.momentValue=function(t){if(this.filled)return this.arr.reduce((function(t,e,i){return t+e*(i+1)}),0)/this.devider},t}();t.ATR=g,t.BollingerBands=S,t.CCI=y,t.Correlation=o,t.DC=A,t.EMA=r,t.HeikenAshi=L,t.LWMA=R,t.Level=n,t.MACD=b,t.Move=p,t.Pivot=C,t.RMA=s,t.ROC=x,t.RSI=w,t.SMA=i,t.StandardDeviation=P,t.Stochastic=d,t.Wave=f,t.cRSI=M,Object.defineProperty(t,"__esModule",{value:!0})}));
